#include "Exp.h"

#include <stdint.h>
#include <limits>

static const double exp2_coeffs[129][8] = {
	// Replace first polynomial to be exact at zero
	//{3.8910986546904177562e-14, 3.5830204618023679866e-11, 2.6466421505757227270e-08, 1.4662262387626025356e-05, 5.4152123481245742834e-03, -1.7144409251321091117e-20, 1.0000000000000000000e+00},
	{3.8805761567865391507e-14, 3.5830323054002511795e-11, 2.6466421444330970344e-08, 1.4662262387640424916e-05, 5.4152123481245725486e-03, 0.0000000000000000000e+00, 1.0000000000000000000e+00},
	{3.9122269356055471342e-14, 3.6024759085951041243e-11, 2.6610131557343245725e-08, 1.4741877022480802287e-05, 5.4446164156797191569e-03, 9.4974627852852131556e-17, 1.0054299011128027264e+00},
	{3.9334699409967289958e-14, 3.6220369965400300670e-11, 2.6754621940298294512e-08, 1.4821923956929973986e-05, 5.4741801444140028229e-03, -1.5252109702996424157e-17, 1.0108892860517004753e+00},
	{3.9548282938065235842e-14, 3.6417042992581554477e-11, 2.6899896891744540178e-08, 1.4902405538317586752e-05, 5.5039044012718399759e-03, -5.7739125937781598273e-17, 1.0163783149109530957e+00},
	{3.9763026203600074285e-14, 3.6614783934851964906e-11, 2.7045960671811304506e-08, 1.4983324126733535436e-05, 5.5337900579050663952e-03, 5.1074730466805157970e-17, 1.0218971486541166271e+00},
	{3.9978935503831411808e-14, 3.6813598590884847464e-11, 2.7192817563759991946e-08, 1.5064682095082772807e-05, 5.5638379906985018300e-03, -4.9578356700289005906e-17, 1.0274459491187637461e+00},
	{4.0196017170212333792e-14, 3.7013492790839772856e-11, 2.7340471874109698650e-08, 1.5146481829154883150e-05, 5.5940490807956499281e-03, 7.5831282727343532578e-18, 1.0330248790212284149e+00},
	{4.0414277568575114956e-14, 3.7214472396533470259e-11, 2.7488927932763479933e-08, 1.5228725727694059040e-05, 5.6244242141245360742e-03, 5.9944931120418693643e-17, 1.0386341019613787306e+00},
	{4.0633723099317844914e-14, 3.7416543301611777488e-11, 2.7638190093135348971e-08, 1.5311416202469433880e-05, 5.6549642814236857416e-03, 8.5500993598283277962e-17, 1.0442737824274137548e+00},
	{4.0854360197592151831e-14, 3.7619711431722437738e-11, 2.7788262732277920694e-08, 1.5394555678345810845e-05, 5.6856701782682485605e-03, 5.5911377810172062854e-17, 1.0499440858006872102e+00},
	{4.1076195333491904254e-14, 3.7823982744688865667e-11, 2.7939150251010773672e-08, 1.5478146593354764519e-05, 5.7165428050962576942e-03, 1.7412273258100947969e-18, 1.0556451783605571570e+00},
	{4.1299235012242935325e-14, 3.8029363230684889308e-11, 2.8090857074049503529e-08, 1.5562191398766147421e-05, 5.7475830672350349329e-03, -1.1991733770920337750e-17, 1.0613772272892620929e+00},
	{4.1523485774393820895e-14, 3.8235858912410364386e-11, 2.8243387650135467872e-08, 1.5646692559159955664e-05, 5.7787918749277406363e-03, -7.9016835160173636867e-17, 1.0671404006768236972e+00},
	{4.1748954196007654768e-14, 3.8443475845267835541e-11, 2.8396746452166259147e-08, 1.5731652552498624916e-05, 5.8101701433600667912e-03, -3.8580636778277011511e-18, 1.0729348675259755552e+00},
	{4.1975646888854909415e-14, 3.8652220117540063503e-11, 2.8550937977326859088e-08, 1.5817073870199661775e-05, 5.8417187926870714487e-03, -6.6585099077166953724e-17, 1.0787607977571198603e+00},
	{4.2203570500607319054e-14, 3.8862097850568592711e-11, 2.8705966747221507848e-08, 1.5902959017208746106e-05, 5.8734387480601640830e-03, 3.1642933317080176276e-17, 1.0846183622133092062e+00},
	{4.2432731715032822954e-14, 3.9073115198933249499e-11, 2.8861837308006327520e-08, 1.5989310512073145077e-05, 5.9053309396542349313e-03, -3.0486516908985251332e-17, 1.0905077326652576897e+00},
	{4.2663137252191537415e-14, 3.9285278350632609650e-11, 2.9018554230522607411e-08, 1.6076130887015601539e-05, 5.9373963026949326538e-03, -5.9218132473386872489e-17, 1.0964290818163768826e+00},
	{4.2894793868632876337e-14, 3.9498593527265474060e-11, 2.9176122110430850304e-08, 1.6163422688008571382e-05, 5.9696357774860868417e-03, 5.2641469017547184311e-17, 1.1023825833078408909e+00},
	{4.3127708357593612099e-14, 3.9713066984213320228e-11, 2.9334545568345549965e-08, 1.6251188474848891181e-05, 6.0020503094372866515e-03, -8.7887140773457095916e-17, 1.1083684117236787259e+00},
	{4.3361887549197148139e-14, 3.9928705010823716630e-11, 2.9493829249970673403e-08, 1.6339430821232838869e-05, 6.0346408490915982165e-03, 1.0408367906607639743e-16, 1.1143867425958924322e+00},
	{4.3597338310653763403e-14, 4.0145513930594764613e-11, 2.9653977826235904125e-08, 1.6428152314831617926e-05, 6.0674083521534459898e-03, -6.2030068308909725606e-17, 1.1204377524096067464e+00},
	{4.3834067546462024314e-14, 4.0363500101360541942e-11, 2.9814995993433613331e-08, 1.6517355557367214262e-05, 6.1003537795166337329e-03, 5.1639254040294685366e-17, 1.1265216186082418481e+00},
	{4.4072082198611231720e-14, 4.0582669915477535098e-11, 2.9976888473356568934e-08, 1.6607043164688724046e-05, 6.1334780972925216289e-03, 3.2354143249066192412e-17, 1.1326385195987191956e+00},
	{4.4311389246785003812e-14, 4.0803029800012092620e-11, 3.0139660013436418831e-08, 1.6697217766849030521e-05, 6.1667822768383621229e-03, 8.9108602901849048560e-17, 1.1387886347566915646e+00},
	{4.4551995708565963432e-14, 4.1024586216928905963e-11, 3.0303315386882875626e-08, 1.6787882008181955151e-05, 6.2002672947857797453e-03, 4.6393269050674602614e-17, 1.1449721444318041730e+00},
	{4.4793908639641491938e-14, 4.1247345663280485555e-11, 3.0467859392823721905e-08, 1.6879038547379784853e-05, 6.2339341330694113957e-03, 3.2487365729354247802e-17, 1.1511892299529826733e+00},
	{4.5037135134010669504e-14, 4.1471314671397696685e-11, 3.0633296856445536825e-08, 1.6970690057571246462e-05, 6.2677837789557044879e-03, -9.1258555937650257312e-17, 1.1574400736337511209e+00},
	{4.5281682324192281962e-14, 4.1696499809081309973e-11, 3.0799632629135170465e-08, 1.7062839226399884382e-05, 6.3018172250718634125e-03, 3.8272096994006116036e-17, 1.1637248587775774755e+00},
	{4.5527557381434001473e-14, 4.1922907679794624594e-11, 3.0966871588622025511e-08, 1.7155488756102888864e-05, 6.3360354694349616672e-03, -1.8678039110194128395e-18, 1.1700437696832501899e+00},
	{4.5774767515922640045e-14, 4.2150544922857073777e-11, 3.1135018639121106561e-08, 1.7248641363590327464e-05, 6.3704395154812049062e-03, 5.5521863910713914962e-17, 1.1763969916502812207e+00},
	{4.6023319976995639987e-14, 4.2379418213638941829e-11, 3.1304078711476810586e-08, 1.7342299780524823741e-05, 6.4050303720953587899e-03, 1.5409476155649440029e-17, 1.1827847109843410145e+00},
	{4.6273222053353611970e-14, 4.2609534263757115136e-11, 3.1474056763307524717e-08, 1.7436466753401656078e-05, 6.4398090536403355608e-03, 3.9799764061192272179e-17, 1.1892071150027210269e+00},
	{4.6524481073274084775e-14, 4.2840899821271899448e-11, 3.1644957779151024747e-08, 1.7531145043629300353e-05, 6.4747765799869350101e-03, 4.6145537745150449462e-17, 1.1956643920398273284e+00},
	{4.6777104404826435185e-14, 4.3073521670884896990e-11, 3.1816786770610634634e-08, 1.7626337427610409679e-05, 6.5099339765437554475e-03, 6.6429204725534752923e-17, 1.2021567314527030756e+00},
	{4.7031099456087890716e-14, 4.3307406634137969254e-11, 3.1989548776502186720e-08, 1.7722046696823231203e-05, 6.5452822742872633979e-03, -4.7487981630989756364e-17, 1.2086843236265816248e+00},
	{4.7286473675360845026e-14, 4.3542561569613278991e-11, 3.2163248863001776038e-08, 1.7818275657903453216e-05, 6.5808225097920246272e-03, -7.7147141624895967225e-17, 1.2152473599804689552e+00},
	{4.7543234551391208298e-14, 4.3778993373134411429e-11, 3.2337892123794341803e-08, 1.7915027132726529970e-05, 6.6165557252611017017e-03, -1.0613115994245830299e-16, 1.2218460329727576230e+00},
	{4.7801389613588051359e-14, 4.4016708977968581152e-11, 3.2513483680223029763e-08, 1.8012303958490416474e-05, 6.6524829685566189488e-03, -1.9008877886093596484e-17, 1.2284805361068700247e+00},
	{4.8060946432244398386e-14, 4.4255715355029969902e-11, 3.2690028681439368490e-08, 1.8110108987798764069e-05, 6.6886052932304861443e-03, -1.0757361937840575144e-16, 1.2351510639369334132e+00},
	{4.8321912618759193427e-14, 4.4496019513084130660e-11, 3.2867532304554272858e-08, 1.8208445088744593728e-05, 6.7249237585552974067e-03, 4.6558984999807224902e-17, 1.2418578120734840020e+00},
	{4.8584295825860560664e-14, 4.4737628498953522644e-11, 3.3045999754789854847e-08, 1.8307315144994375938e-05, 6.7614394295553914213e-03, -8.2639516516364171133e-17, 1.2486009771892048192e+00},
	{4.8848103747830137514e-14, 4.4980549397724151362e-11, 3.3225436265632074757e-08, 1.8406722055872615408e-05, 6.7981533770380825343e-03, -6.7329125827615429322e-18, 1.2553807570246910963e+00},
	{4.9113344120728789830e-14, 4.5224789332953333120e-11, 3.3405847098984186529e-08, 1.8506668736446849131e-05, 6.8350666776250661866e-03, -3.0866288502669555208e-17, 1.2621973503942507389e+00},
	{4.9380024722623406254e-14, 4.5470355466878609827e-11, 3.3587237545321083019e-08, 1.8607158117613156056e-05, 6.8721804137839839419e-03, 2.6461750023713101996e-18, 1.2690509571917332199e+00},
	{4.9648153373815005231e-14, 4.5717255000627755930e-11, 3.3769612923844395682e-08, 1.8708193146182080109e-05, 6.9094956738601715288e-03, 9.9132427174113217674e-17, 1.2759417783963920012e+00},
	{4.9917737937068091591e-14, 4.5965495174429955045e-11, 3.3952978582638494211e-08, 1.8809776784965064820e-05, 6.9470135521085708136e-03, 1.7113955133863707136e-17, 1.2828700160787782636e+00},
	{5.0188786317841174324e-14, 4.6215083267828120416e-11, 3.4137339898827333219e-08, 1.8911912012861318254e-05, 6.9847351487258213174e-03, 8.9470461834895204498e-17, 1.2898358734066657227e+00},
	{5.0461306464518647510e-14, 4.6466026599892378596e-11, 3.4322702278732106246e-08, 1.9014601824945186144e-05, 7.0226615698825208683e-03, 2.5360269246830078555e-17, 1.2968395546510096406e+00},
	{5.0735306368643819829e-14, 4.6718332529434658200e-11, 3.4509071158029793120e-08, 1.9117849232553955333e-05, 7.0607939277556631963e-03, 8.6454401708653135979e-17, 1.3038812651919358121e+00},
	{5.1010794065153307229e-14, 4.6972008455224532337e-11, 3.4696452001912574208e-08, 1.9221657263376199307e-05, 7.0991333405612550705e-03, -7.1837837010717523192e-17, 1.3109612115247644137e+00},
	{5.1287777632612643584e-14, 4.7227061816206133806e-11, 3.4884850305248065222e-08, 1.9326028961540520144e-05, 7.1376809325871043085e-03, -5.4602155967601455350e-17, 1.3180796012660640493e+00},
	{5.1566265193453147230e-14, 4.7483500091716362759e-11, 3.5074271592740491712e-08, 1.9430967387704846117e-05, 7.1764378342257907975e-03, -2.8610032499753793577e-17, 1.3252366431597413232e+00},
	{5.1846264914210163265e-14, 4.7741330801704147717e-11, 3.5264721419092664260e-08, 1.9536475619146179914e-05, 7.2154051820078135906e-03, -5.1038710078054413068e-17, 1.3324325470831615004e+00},
	{5.2127785005762504926e-14, 4.8000561506951005534e-11, 3.5456205369168873509e-08, 1.9642556749850827977e-05, 7.2545841186349210167e-03, 8.9249858140024247054e-17, 1.3396675240533029161e+00},
	{5.2410833723573239178e-14, 4.8261199809292758105e-11, 3.5648729058158691770e-08, 1.9749213890605134671e-05, 7.2939757930136185984e-03, 3.2217558491325907082e-17, 1.3469417862329458035e+00},
	{5.2695419367931797592e-14, 4.8523253351842438161e-11, 3.5842298131741595205e-08, 1.9856450169086714509e-05, 7.3335813602888599849e-03, 7.6986265886702338849e-17, 1.3542555469368926513e+00},
	{5.2981550284197336781e-14, 4.8786729819214422899e-11, 3.6036918266252545531e-08, 1.9964268729956151941e-05, 7.3734019818779226313e-03, 1.5104436789805558897e-18, 1.3616090206382247541e+00},
	{5.3269234863043518781e-14, 4.9051636937749782537e-11, 3.6232595168848458463e-08, 2.0072672734949236460e-05, 7.4134388255044638902e-03, 9.5914508453382953880e-17, 1.3690024229745905160e+00},
	{5.3558481540704515750e-14, 4.9317982475742869646e-11, 3.6429334577675519190e-08, 2.0181665362969661894e-05, 7.4536930652327661878e-03, -6.9009487540308861792e-17, 1.3764359707545301692e+00},
	{5.3849298799222415675e-14, 4.9585774243669097543e-11, 3.6627142262037510326e-08, 2.0291249810182264402e-05, 7.4941658815021643461e-03, -6.7728842905331195832e-17, 1.3839098819638320226e+00},
	{5.4141695166695965999e-14, 4.9855020094413985313e-11, 3.6826024022564933943e-08, 2.0401429290106734809e-05, 7.5348584611616619897e-03, -4.9085603801830388898e-17, 1.3914243757719262362e+00},
	{5.4435679217530636212e-14, 5.0125727923503450061e-11, 3.7025985691385159317e-08, 2.0512207033711852720e-05, 7.5757719975047353028e-03, -9.6166116770553499008e-17, 1.3989796725383112364e+00},
	{5.4731259572690087777e-14, 5.0397905669335333475e-11, 3.7227033132293437559e-08, 2.0623586289510245786e-05, 7.6169076903043267390e-03, 7.0107998976553043833e-18, 1.4065759938190154354e+00},
	{5.5028444899948937787e-14, 5.0671561313412188539e-11, 3.7429172240924822829e-08, 2.0735570323653643643e-05, 7.6582667458480269476e-03, -9.6697178990611217683e-17, 1.4142135623730951455e+00},
	{5.5327243914146980434e-14, 5.0946702880575339341e-11, 3.7632408944927106026e-08, 2.0848162420028650232e-05, 7.6998503769734475202e-03, -1.6102206424573256771e-17, 1.4218926021691655759e+00},
	{5.5627665377444714832e-14, 5.1223338439240213956e-11, 3.7836749204134621980e-08, 2.0961365880353058225e-05, 7.7416598031037914956e-03, -1.2056152365198194263e-17, 1.4296133383919700233e+00},
	{5.5929718099580324351e-14, 5.1501476101632918097e-11, 3.8042199010742989697e-08, 2.1075184024272654721e-05, 7.7836962502836051433e-03, -4.2064983127023855698e-17, 1.4373759974489823676e+00},
	{5.6233410938127987537e-14, 5.1781124024028165868e-11, 3.8248764389484891554e-08, 2.1189620189458579217e-05, 7.8259609512147387811e-03, -3.0262358121136841743e-17, 1.4451808069770466503e+00},
	{5.6538752798757627920e-14, 5.2062290406988412507e-11, 3.8456451397806686280e-08, 2.1304677731705186404e-05, 7.8684551452924914733e-03, -5.7824397400575514372e-17, 1.4530279958490526226e+00},
	{5.6845752635496083778e-14, 5.2344983495604383001e-11, 3.8665266126046087358e-08, 2.1420360025028478175e-05, 7.9111800786419543552e-03, -5.6028818433298130950e-17, 1.4609177941806470447e+00},
	{5.7154419450989678903e-14, 5.2629211579736815615e-11, 3.8875214697610721534e-08, 2.1536670461765020128e-05, 7.9541370041545551850e-03, 8.4633644992378165053e-17, 1.4688504333369818422e+00},
	{5.7464762296768200712e-14, 5.2914982994259562524e-11, 3.9086303269157726277e-08, 2.1653612452671423897e-05, 7.9973271815248006544e-03, -3.4865264880766998139e-17, 1.4768261459394993462e+00},
	{5.7776790273510374022e-14, 5.3202306119304034607e-11, 3.9298538030774273672e-08, 2.1771189427024385127e-05, 8.0407518772872103863e-03, 1.0777541085087623020e-16, 1.4848451658727523927e+00},
	{5.8090512531310685367e-14, 5.3491189380504919326e-11, 3.9511925206159100172e-08, 2.1889404832721226285e-05, 8.0844123648534643028e-03, 1.4167325133215750180e-17, 1.4929077282912648350e+00},
	{5.8405938269947734545e-14, 5.3781641249247268620e-11, 3.9726471052805002490e-08, 2.2008262136381012068e-05, 8.1283099245497390795e-03, -6.4163406757404018468e-17, 1.5010140696264255844e+00},
	{5.8723076739154025046e-14, 5.4073670242914918047e-11, 3.9942181862182359202e-08, 2.2127764823446203520e-05, 8.1724458436542579687e-03, -1.0167140650800370297e-16, 1.5091644275934228414e+00},
	{5.9041937238887155499e-14, 5.4367284925140256557e-11, 4.0159063959923598638e-08, 2.2247916398284871189e-05, 8.2168214164350366485e-03, -4.3113008944816904316e-17, 1.5173590411982147419e+00},
	{5.9362529119602626708e-14, 5.4662493906055340425e-11, 4.0377123706008705717e-08, 2.2368720384293463944e-05, 8.2614379441878389720e-03, -1.1027557260247503842e-16, 1.5255981507445384171e+00},
	{5.9684861782527948724e-14, 5.4959305842544409528e-11, 4.0596367494951741245e-08, 2.2490180324000113112e-05, 8.3062967352743356797e-03, 8.8725970943670247941e-17, 1.5338819978409559130e+00},
	{6.0008944679938376136e-14, 5.5257729438497709001e-11, 4.0816801755988327372e-08, 2.2612299779168536316e-05, 8.3513991051604730131e-03, 7.9471907803433598676e-17, 1.5422108254079407441e+00},
	{6.0334787315434094854e-14, 5.5557773445066764935e-11, 4.1038432953264224910e-08, 2.2735082330902476634e-05, 8.3967463764550442917e-03, -1.4627290452411326466e-17, 1.5505848776849999737e+00},
	{6.0662399244218898273e-14, 5.5859446660920984846e-11, 4.1261267586024837109e-08, 2.2858531579750707586e-05, 8.4423398789484800642e-03, 3.7785342324112984484e-17, 1.5590044002378369292e+00},
	{6.0991790073380365422e-14, 5.6162757932505666942e-11, 4.1485312188805845007e-08, 2.2982651145812634419e-05, 8.4881809496518429575e-03, -1.0354749102949381268e-16, 1.5674696399655529966e+00},
	{6.1322969462171654699e-14, 5.6467716154301456955e-11, 4.1710573331624815548e-08, 2.3107444668844440893e-05, 8.5342709328360289583e-03, -1.0163935731859076682e-17, 1.5759808451078864966e+00},
	{6.1655947122294673382e-14, 5.6774330269085129753e-11, 4.1937057620173848637e-08, 2.3232915808365828980e-05, 8.5806111800711959425e-03, -1.9364883007079568936e-17, 1.5845382652524937495e+00},
	{6.1990732818184925839e-14, 5.7082609268191870216e-11, 4.2164771696013309457e-08, 2.3359068243767327778e-05, 8.6272030502663916984e-03, -1.0097137890415777088e-16, 1.5931421513422669989e+00},
	{6.2327336367297851099e-14, 5.7392562191778917674e-11, 4.2393722236766566641e-08, 2.3485905674418198732e-05, 8.6740479097094091987e-03, -6.0576636325817068537e-17, 1.6017927556826934143e+00},
	{6.2665767640396675044e-14, 5.7704198129090657900e-11, 4.2623915956315842166e-08, 2.3613431819774903281e-05, 8.7211471321068465695e-03, 2.4679581664451655639e-17, 1.6104903319492542835e+00},
	{6.3006036561841916049e-14, 5.8017526218725201454e-11, 4.2855359604999053870e-08, 2.3741650419490193931e-05, 8.7685020986243908392e-03, 2.0913573324397192079e-17, 1.6192351351948637284e+00},
	{6.3348153109882354751e-14, 5.8332555648902332040e-11, 4.3088059969807802790e-08, 2.3870565233522757583e-05, 8.8161141979273237312e-03, -6.7157462415463536973e-17, 1.6280274218573478340e+00},
	{6.3692127316947707754e-14, 5.8649295657732934739e-11, 4.3322023874586379579e-08, 2.4000180042247495839e-05, 8.8639848262212460328e-03, 7.6955187587749794162e-17, 1.6368674497669644108e+00},
	{6.4037969269942778081e-14, 5.8967755533489962284e-11, 4.3557258180231862806e-08, 2.4130498646566364340e-05, 8.9121153872930135992e-03, -1.0128501464219279733e-16, 1.6457554781539649458e+00},
	{6.4385689110543271710e-14, 5.9287944614880739040e-11, 4.3793769784895342218e-08, 2.4261524868019842307e-05, 8.9605072925519023419e-03, 9.6404574319110795752e-17, 1.6546917676561943011e+00},
	{6.4735297035493191816e-14, 5.9609872291320880574e-11, 4.4031565624184180948e-08, 2.4393262548898994997e-05, 9.0091619610710074045e-03, 5.8881404214976040998e-17, 1.6636765803267363761e+00},
	{6.5086803296903835993e-14, 5.9933548003209550923e-11, 4.4270652671365389447e-08, 2.4525715552358152803e-05, 9.0580808196288487705e-03, -5.4795837273874255881e-17, 1.6727101796415966284e+00},
	{6.5440218202554472160e-14, 6.0258981242206400086e-11, 4.4511037937570137616e-08, 2.4658887762528190052e-05, 9.1072653027512093238e-03, 8.1961266861252815143e-17, 1.6817928305074290041e+00},
	{6.5795552116194579578e-14, 6.0586181551509819817e-11, 4.4752728471999358824e-08, 2.4792783084630420443e-05, 9.1567168527532088323e-03, -9.6725704650720684346e-17, 1.6909247992693052787e+00},
	{6.6152815457847781179e-14, 6.0915158526136840877e-11, 4.4995731362130432560e-08, 2.4927405445091132841e-05, 9.2064369197815930368e-03, -8.0528666894966213054e-18, 1.7001063537185234775e+00},
	{6.6512018704117391479e-14, 6.1245921813204464903e-11, 4.5240053733925038381e-08, 2.5062758791656719999e-05, 9.2564269618572638659e-03, -9.8717100152488646370e-17, 1.7093377631004629258e+00},
	{6.6873172388493643193e-14, 6.1578481112212624809e-11, 4.5485702752038141438e-08, 2.5198847093509447629e-05, 9.3066884449180316968e-03, -1.8543268895225340652e-17, 1.7186192981224779341e+00},
	{6.7236287101662579922e-14, 6.1912846175328528120e-11, 4.5732685620028050026e-08, 2.5335674341383843507e-05, 9.3572228428616000678e-03, -1.0753944331511636051e-16, 1.7279512309618376698e+00},
	{6.7601373491816627537e-14, 6.2249026807672745140e-11, 4.5981009580567703989e-08, 2.5473244547683733709e-05, 9.4080316375887984570e-03, 3.1614107430651469484e-17, 1.7373338352737062174e+00},
	{6.7968442264966844256e-14, 6.2587032867606615441e-11, 4.6230681915657021904e-08, 2.5611561746599898875e-05, 9.4591163190470266969e-03, -1.0755285213001100623e-16, 1.7467673861991690476e+00},
	{6.8337504185256862041e-14, 6.2926874267021463810e-11, 4.6481709946836485735e-08, 2.5750629994228380998e-05, 9.5104783852739509242e-03, 2.9571297048702776872e-17, 1.7562521603732994535e+00},
	{6.8708570075278557178e-14, 6.3268560971629160366e-11, 4.6734101035401790893e-08, 2.5890453368689413620e-05, 9.5621193424414371864e-03, 9.4582876781235795881e-17, 1.7657884359332727264e+00},
	{6.9081650816389399555e-14, 6.3612103001254438430e-11, 4.6987862582619760228e-08, 2.6031035970247029667e-05, 9.6140407048997140321e-03, 6.4266880184402672471e-17, 1.7753764925265211883e+00},
	{6.9456757349031568983e-14, 6.3957510430128685814e-11, 4.7243002029945349899e-08, 2.6172381921429285913e-05, 9.6662439952217796973e-03, 1.5299797065726456933e-17, 1.7850166113189349648e+00},
	{6.9833900673052750218e-14, 6.4304793387185338777e-11, 4.7499526859239899324e-08, 2.6314495367149154912e-05, 9.7187307442480573572e-03, 1.8196689201043175769e-17, 1.7947090750031071682e+00},
	{7.0213091848028720272e-14, 6.4653962056356969108e-11, 4.7757444592990492863e-08, 2.6457380474826081002e-05, 9.7715024911312810957e-03, -5.1803160388661306117e-17, 1.8044541678066239321e+00},
	{7.0594341993587652290e-14, 6.5005026676873896327e-11, 4.8016762794530585430e-08, 2.6601041434508186829e-05, 9.8245607833816316762e-03, -9.9726419670985368662e-17, 1.8142521755003988559e+00},
	{7.0977662289736224332e-14, 6.5357997543564428401e-11, 4.8277489068261799393e-08, 2.6745482458995137174e-05, 9.8779071769121134378e-03, -1.0162755179772696607e-16, 1.8241033854070534126e+00},
	{7.1363063977187406861e-14, 6.5712885007156795590e-11, 4.8539631059876879527e-08, 2.6890707783961683786e-05, 9.9315432360841914006e-03, 3.2799629257252639939e-17, 1.8340080864093424307e+00},
	{7.1750558357690156112e-14, 6.6069699474582635259e-11, 4.8803196456583944990e-08, 2.7036721668081874296e-05, 9.9854705337536556198e-03, -5.9429033987003632658e-17, 1.8439665689586259845e+00},
	{7.2140156794360798781e-14, 6.6428451409282221524e-11, 4.9068192987331886110e-08, 2.7183528393153931978e-05, 1.0039690651316744013e-02, 9.7587089530412099626e-17, 1.8539791250833854708e+00},
	{7.2531870712016272116e-14, 6.6789151331511258788e-11, 4.9334628423037018492e-08, 2.7331132264225823302e-05, 1.0094205178756523664e-02, 6.5377168837888676016e-17, 1.8640460483977889794e+00},
	{7.2925711597509118434e-14, 6.7151809818649381332e-11, 4.9602510576810981204e-08, 2.7479537609721506499e-05, 1.0149015714689514980e-02, -6.1259765626966187769e-17, 1.8741676341102999626e+00},
	{7.3321691000064360279e-14, 6.7516437505510384824e-11, 4.9871847304189826101e-08, 2.7628748781567837424e-05, 1.0204123866412560459e-02, -8.2298237223112790858e-17, 1.8843441790323345320e+00},
	{7.3719820531618205743e-14, 6.7883045084654047556e-11, 5.0142646503364377696e-08, 2.7778770155322224204e-05, 1.0259531249949970996e-02, 3.4001553966179246820e-17, 1.8945759815869656073e+00},
	{7.4120111867158457725e-14, 6.8251643306699644821e-11, 5.0414916115411870209e-08, 2.7929606130300901900e-05, 1.0315239490100909861e-02, 6.5305917390482825717e-17, 1.9048633418176741383e+00},
	{7.4522576745067005775e-14, 6.8622242980641324449e-11, 5.0688664124528808829e-08, 2.8081261129707966122e-05, 1.0371250220487036875e-02, -1.0623229564704904036e-16, 1.9152065613971474001e+00},
	{7.4927226967463984030e-14, 6.8994854974164929906e-11, 5.0963898558265075063e-08, 2.8233739600765074101e-05, 1.0427565083600416271e-02, -9.9182651073291885719e-17, 1.9256059436361250281e+00},
	{7.5334074400553847635e-14, 6.9369490213966813794e-11, 5.1240627487759368812e-08, 2.8387046014841853882e-05, 1.0484185730851681290e-02, 1.0329066697103978594e-16, 1.9360617934922943473e+00},
	{7.5743130974973380323e-14, 6.9746159686074202319e-11, 5.1518859027975868049e-08, 2.8541184867587028411e-05, 1.0541113822618464191e-02, 6.8076850626885650116e-17, 1.9465744175792332182e+00},
	{7.6154408686141557369e-14, 7.0124874436167330441e-11, 5.1798601337942205376e-08, 2.8696160679060251134e-05, 1.0598351028294081266e-02, 8.9574123830537993437e-17, 1.9571441241754001794e+00},
	{7.6567919594611289213e-14, 7.0505645569903438179e-11, 5.2079862620988728357e-08, 2.8851977993864649709e-05, 1.0655899026336490207e-02, -1.0318301639047538912e-16, 1.9677712232331758813e+00},
	{7.6983675826423058326e-14, 7.0888484253242343732e-11, 5.2362651124989050262e-08, 2.9008641381280098173e-05, 1.0713759504317509411e-02, 4.0354833649476031561e-17, 1.9784560263879509279e+00},
	{7.7401689573460600826e-14, 7.1273401712773929454e-11, 5.2646975142601937528e-08, 2.9166155435397207388e-05, 1.0771934158972306175e-02, 8.1710289992545376029e-18, 1.9891988469672663431e+00},
	// An extra entry at the end, to handle x being exactly 1 or slightly above (exact at 1),
	// avoiding the need for a bounds check.
	{7.7611523135730783013e-14, 7.1660646108005023589e-11, 5.2932842888661940688e-08, 2.9324524775280849832e-05, 1.0830424696249145097e-02, 0.0000000000000000000e+00, 2.0000000000000000000e+00}
};

double exp2_single(double x) {
	// Unlike sin and cos that have special cases for being near 0 or 1,
	// this just adjusts the coefficients for the first span to be exact at 0,
	// instead of exact in the middle of the span.

	x *= 128;
	//(*(uint64_t*)&x) += (7ULL<<52);
	// NOTE: Casting to int64_t is faster than casting to size_t on x86
	int64_t index = int64_t(x);
	x -= index;

	// x should be in [0,1)
	const double*const coeffs = exp2_coeffs[index];
	return (((((coeffs[0]*x + coeffs[1])*x + coeffs[2])*x + coeffs[3])*x + coeffs[4])*x + coeffs[5]) + coeffs[6];
}

double exp2(double x) {
	if (x < -1022) {
		// TODO: Support denormal numbers.
		return 0.0;
	}
	if (x >= 1024) {
		return std::numeric_limits<double>::infinity();
	}
	// Check for NaN values.
	if (x != x) {
		return x;
	}

	// Floor to get exponent and subtract to get fractional part.
	int64_t exponent = int64_t(x);
	exponent -= (exponent > x);
	x -= exponent;

	// Exponentiate fractional part and add in exponent.
	double out = exp2_single(x);
	static_assert(sizeof(double) == sizeof(int64_t), "The following code assumes that double and int64_t are the same size, to deal with the exponent.");
	(*(int64_t*)&out) += (exponent << 52);

	return out;
}
